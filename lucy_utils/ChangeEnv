#!/bin/bash

Header

if [[ -z "$1" ]]; then
    echo -e "\033[31mYou must specify a ros distribution.\033[0m"
    exit 1
fi

DISTRIBUTIONS=("humble" "jazzy")

DIRENV=$(command -v direnv 2> /dev/null)
LN=$(command -v ln 2> /dev/null)

for distribution in "${DISTRIBUTIONS[@]}"; do
    if [[ "$distribution" == "$1" ]]; then
        echo "# This file is a generated file, use ChangeEnv script to change ros distro" > $LUCY/.rosdistro.env
        echo "export ROS_DISTRO=\"$distribution\"" >> $LUCY/.rosdistro.env
        if [[ -z "$DIRENV" ]]; then
            echo -e "\033[33mSource .envrc file\033[0m"
        else
            $DIRENV allow .
        fi
        exit 0
    fi
done

echo -e "Distribution not found or not supported yet"
exit 1
